{"ast":null,"code":"import { ApolloServer } from 'apollo-server-micro';\nimport resolvers from \"./resolvers\";\nimport typeDefs from \"./schemas\";\nimport { init } from \"./db/connection\";\nimport cookies from \"../../utils/cookies\";\ninit();\nconst apolloServer = new ApolloServer({\n  typeDefs,\n  resolvers,\n  context: ({\n    req,\n    res,\n    connection\n  }) => {\n    let user = req && req.user ? req.user : null;\n    console.log(req && 'req 90asda0-sdasd yeah ');\n    console.log(res && 'res 90asda0-sdasd yeah ');\n    console.log(connection && 'conn 90asda0-sdasd yeah ');\n\n    if (!req) {\n      if (connection && connection.context && connection.context.user) {\n        user = connection.context.user;\n      }\n\n      return {\n        user\n      };\n    }\n\n    const requestInfo = {\n      secure: req.secure,\n      cookies: req.cookies\n    };\n    return {\n      user,\n      res,\n      requestInfo\n    };\n  }\n});\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\nconst handler = apolloServer.createHandler({\n  path: '/api/graphql'\n});\nexport default cookies(handler);","map":{"version":3,"sources":["/home/erxes/work/erxes-client-portal/client/pages/api/graphql.ts"],"names":["ApolloServer","resolvers","typeDefs","init","cookies","apolloServer","context","req","res","connection","user","console","log","requestInfo","secure","config","api","bodyParser","handler","createHandler","path"],"mappings":"AAAA,SAASA,YAAT,QAA6B,qBAA7B;AACA,OAAOC,SAAP;AACA,OAAOC,QAAP;AACA,SAASC,IAAT;AACA,OAAOC,OAAP;AAEAD,IAAI;AAEJ,MAAME,YAAY,GAAG,IAAIL,YAAJ,CAAiB;AACpCE,EAAAA,QADoC;AAEpCD,EAAAA,SAFoC;AAGpCK,EAAAA,OAAO,EAAE,CAAC;AAAEC,IAAAA,GAAF;AAAOC,IAAAA,GAAP;AAAYC,IAAAA;AAAZ,GAAD,KAA8B;AACrC,QAAIC,IAAI,GAAGH,GAAG,IAAIA,GAAG,CAACG,IAAX,GAAkBH,GAAG,CAACG,IAAtB,GAA6B,IAAxC;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYL,GAAG,IAAI,yBAAnB;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAYJ,GAAG,IAAI,yBAAnB;AACAG,IAAAA,OAAO,CAACC,GAAR,CAAYH,UAAU,IAAI,0BAA1B;;AAEA,QAAI,CAACF,GAAL,EAAU;AACR,UAAIE,UAAU,IAAIA,UAAU,CAACH,OAAzB,IAAoCG,UAAU,CAACH,OAAX,CAAmBI,IAA3D,EAAiE;AAC/DA,QAAAA,IAAI,GAAGD,UAAU,CAACH,OAAX,CAAmBI,IAA1B;AACD;;AAED,aAAO;AACLA,QAAAA;AADK,OAAP;AAGD;;AAED,UAAMG,WAAW,GAAG;AAClBC,MAAAA,MAAM,EAAEP,GAAG,CAACO,MADM;AAElBV,MAAAA,OAAO,EAAEG,GAAG,CAACH;AAFK,KAApB;AAKA,WAAO;AACLM,MAAAA,IADK;AAELF,MAAAA,GAFK;AAGLK,MAAAA;AAHK,KAAP;AAKD;AA7BmC,CAAjB,CAArB;AAgCA,OAAO,MAAME,MAAM,GAAG;AACpBC,EAAAA,GAAG,EAAE;AACHC,IAAAA,UAAU,EAAE;AADT;AADe,CAAf;AAMP,MAAMC,OAAO,GAAGb,YAAY,CAACc,aAAb,CAA2B;AAAEC,EAAAA,IAAI,EAAE;AAAR,CAA3B,CAAhB;AAEA,eAAehB,OAAO,CAACc,OAAD,CAAtB","sourcesContent":["import { ApolloServer } from 'apollo-server-micro';\nimport resolvers from './resolvers';\nimport typeDefs from './schemas';\nimport { init } from './db/connection';\nimport cookies from '../../utils/cookies';\n\ninit();\n\nconst apolloServer = new ApolloServer({\n  typeDefs,\n  resolvers,\n  context: ({ req, res, connection }) => {\n    let user = req && req.user ? req.user : null;\n    console.log(req && 'req 90asda0-sdasd yeah ');\n    console.log(res && 'res 90asda0-sdasd yeah ');\n    console.log(connection && 'conn 90asda0-sdasd yeah ');\n\n    if (!req) {\n      if (connection && connection.context && connection.context.user) {\n        user = connection.context.user;\n      }\n\n      return {\n        user\n      };\n    }\n\n    const requestInfo = {\n      secure: req.secure,\n      cookies: req.cookies\n    };\n\n    return {\n      user,\n      res,\n      requestInfo\n    };\n  }\n});\n\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\n\nconst handler = apolloServer.createHandler({ path: '/api/graphql' });\n\nexport default cookies(handler);\n"]},"metadata":{},"sourceType":"module"}